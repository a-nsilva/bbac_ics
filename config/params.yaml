# BBAC_ICS - Global Configuration
# Adaptive baseline settings for behavioral modeling

baseline:
  # Sliding window configuration
  window_days: 10                    # Number of days for baseline window
  recent_weight: 0.7                 # Weight for recent data (70%)
  # historical_weight is automatically 1 - recent_weight (30%)
  
  # Historical baseline archiving
  max_historical_baselines: 10       # Maximum number of archived baselines per agent
  
  # Baseline update triggers
  update_on_buffer_full: true        # Update when trusted buffer is full
  update_on_drift_detected: false    # Update when drift is detected (future)

  enable_behavioral: true          # Flag para camada comportamental

  # Adicionar em baseline:
  drift_detection:
    enabled: false           # Ativar depois
    method: kl_divergence    # ou 'ks_test'
    threshold: 0.15
    min_samples: 50
    check_interval_hours: 6

fusion:
  fusion_method: weighted_voting # Options: 'weighted_voting', 'rule_priority', 'high_confidence_denial'
  enable_ml: true                  # Flag para camada ML/sequence
  
  # Layer weights (must sum to 1.0)
  weights:
    rule: 0.4           # Policy/RuBAC layer weight
    behavioral: 0.3     # Statistical analysis layer weight
    ml: 0.3             # ML/Sequence layer weight
  
  # Thresholds
  high_confidence_threshold: 0.9   # Threshold for high-confidence denial strategy
  decision_threshold: 0.5          # Threshold for grant vs deny (score >= threshold → grant)
  
  # Meta-classifier settings
  use_meta_classifier: false
  meta_classifier_model: logistic_regression  # option: 'xgboost'

ml_params:
  statistical:
    anomaly_threshold: 0.5
    contamination: 0.1
  sequence:
    anomaly_threshold: 0.5
    sequence_length: 5

  # Continuous learning
learning:
  buffer_size: 1000                  # Trusted buffer size before triggering updates
  min_samples_for_update: 100        # Minimum samples required for profile update
  trust_threshold: 0.8

# Policy engine
policy:
  maintenance_hours: [2, 3]          # Maintenance hours (2 AM - 4 AM)
  enable_policy: true              # Flag para camada de política

ros:
  node_name: bbac_node
  target_latency_ms: 100.0          # Target decision latency (sub-100ms goal)
  qos_depth: 10                     # ROS2 QoS queue depth

# File paths
paths:
  data_dir: data/raw
  profiles_dir: profiles
  logs_dir: logs
  quarantine_dir: quarantine
  train_file: trainer.csv
  validation_file: validation.csv
  test_file: test.csv

thresholds:
  max_auth_attempts: 3
  trust_threshold: 0.8
  min_confidence_for_update: 0.7
  require_grant_for_update: true
  # Decision thresholds (score = legitimacy/confidence)
  t_min_deny: 0.2         # score < 0.2 → DENY + ALERT (crítico)
  t1_review: 0.4          # 0.2 ≤ score < 0.4 → MANUAL REVIEW
  t2_mfa: 0.6             # 0.4 ≤ score < 0.6 → MFA
  
  high_confidence_alert: 0.8   # Para logs/monitoramento

emergency_defaults:
  severity: high
  priority: 80
  required_actions:
    - log_incident
    - notify_supervisor
  notifications:
    - supervisor
    - security_officer

# Dataset generation configuration
dataset_generation:
  total_samples: 100000
  train_ratio: 0.7
  val_ratio: 0.15
  test_ratio: 0.15
  train_anomaly_rate: 0.05
  val_anomaly_rate: 0.10
  test_anomaly_rate: 0.15
