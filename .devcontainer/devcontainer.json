{
    "name": "BBAC Framework (ROS 2 Humble)",
    
    // Opção A: Se tiveres um Dockerfile dentro da pasta .devcontainer/ (Recomendado)
    "build": {
        "dockerfile": "Dockerfile",
        "context": ".."
    },

    // Opção B: Se não tiveres Dockerfile, comenta o bloco acima e usa a imagem direta:
    // "image": "osrf/ros:humble-desktop-full",

    "remoteUser": "ros",
    
    // Configurações críticas para a estrutura sem 'src'
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-vscode.cpptools",
                "ms-iot.vscode-ros"
            ],
            "settings": {
                "python.defaultInterpreterPath": "/usr/bin/python3",
                "python.analysis.typeCheckingMode": "basic",
                
                // CRÍTICO: Diz ao Pylance que a raiz do projeto contém os módulos
                "python.analysis.extraPaths": [
                    "${workspaceFolder}/install/bbac_ics/local/lib/python3.10/dist-packages",
                    "${workspaceFolder}/bbac_ics_core"
                ],
                
                // Formatação automática (opcional, mas bom para papers)
                "editor.formatOnSave": true,
                "python.formatting.provider": "black"
            }
        }
    },

    // Variáveis de ambiente dentro do container
    "remoteEnv": {
        // CRÍTICO: Adiciona a raiz do workspace ao PYTHONPATH
        // Isso permite fazer "import bbac" nos scripts e no terminal
        "PYTHONPATH": "${workspaceFolder}/install/bbac_ics/local/lib/python3.10/dist-packages:${workspaceFolder}",
        
        // Define um ID para evitar conflitos de ROS na rede
        "ROS_LOCALHOST_ONLY": "1"
    },

    // Permissões para GUI (Matplotlib/Rviz)
    "runArgs": [
        "--net=host",
        "--cap-add=SYS_PTRACE"
        // Descomenta as linhas abaixo se estiveres em Linux com X11 para ver gráficos
        // "-e", "DISPLAY=${env:DISPLAY}",
        // "-v", "/tmp/.X11-unix:/tmp/.X11-unix"
    ],

    // Comandos executados após a criação do container
    // Instala dependências do Python e do ROS automaticamente
    "postCreateCommand": "sudo apt-get update && sudo apt-get install -y python3-pip && pip3 install -r requirements.lock && rosdep update && rosdep install --from-paths . --ignore-src -y && colcon build --symlink-install"
}
